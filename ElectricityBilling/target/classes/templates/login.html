<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Login</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" th:href="@{/login.css}">
</head>
<body>
<div class="theme-switcher" id="theme-switcher">
  <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 12h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.64 5.64c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L5.64 2.81c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41L5.64 5.64zm12.72 12.72c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41l-1.41-1.41c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41l1.41 1.41zM4.22 18.36c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0l1.41-1.41c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0l-1.41 1.41zM18.36 4.22c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0l1.41-1.41c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0l-1.41 1.41z"/></svg>
  <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.3 2.3c-5.52 0-10 4.48-10 10s4.48 10 10 10c2.21 0 4.24-.72 5.92-1.94-.53-.2-.99-.49-1.38-.83-.79-.68-1.24-1.68-1.24-2.73 0-2.07 1.68-3.75 3.75-3.75.96 0 1.84.36 2.53.95.22.19.47.35.74.49.07-.52.11-1.05.11-1.59 0-5.52-4.48-10-10-10z"/></svg>
</div>
<div class="login-container">
  <div class="login-card card">
    <div class="card-header"><h1>ðŸ’¡ WattWise</h1></div>
    <div class="card-body">
      <p class="text-center text-muted mb-4">Effortless energy management at your fingertips.</p>
      <div class="alert alert-success" th:if="${param.registered}">User created successfully. Please sign in.</div>
      <div class="alert alert-danger" th:if="${param.error}">Wrong username or password.</div>
      <form method="post" th:action="@{/login}">
        <div class="mb-3"><label class="form-label">Username</label><input class="form-control" name="username" placeholder="Username" required></div>
        <div class="mb-3"><label class="form-label">Password</label><input class="form-control" type="password" name="password" required></div>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        <button class="btn btn-primary w-100">Login</button>
      </form>
      <hr><div class="text-center"><a href="/register">Create a new user</a></div>
    </div>
  </div>
</div>
<script>
  const themeSwitcher = document.getElementById('theme-switcher');
  const body = document.body;

  const applyTheme = (theme) => {
    if (theme === 'dark') {
      body.classList.add('dark-mode');
    } else {
      body.classList.remove('dark-mode');
    }
  };

  themeSwitcher.addEventListener('click', () => {
    const isDarkMode = body.classList.contains('dark-mode');
    if (isDarkMode) {
      localStorage.setItem('theme', 'light');
      applyTheme('light');
    } else {
      localStorage.setItem('theme', 'dark');
      applyTheme('dark');
    }
  });

  // Apply saved theme on page load
  const savedTheme = localStorage.getItem('theme') || 'light';
  applyTheme(savedTheme);
</script>
</body>
</html>
